<?xml version="1.0" encoding="UTF-8"?>

<schema name="example" version="1.1">
	<types>
		<fieldtype name="string" class="solr.StrField" sortMissingLast="true" omitNorms="true" />

		<fieldtype name="boolean" class="solr.BoolField" sortMissingLast="true" omitNorms="true" />

		<fieldtype name="integer" class="solr.IntField" omitNorms="true" />
		<fieldtype name="long" class="solr.LongField" omitNorms="true" />
		<fieldtype name="float" class="solr.FloatField" omitNorms="true" />
		<fieldtype name="double" class="solr.DoubleField" omitNorms="true" />

		<fieldtype name="sint" class="solr.SortableIntField" sortMissingLast="true" omitNorms="true" />
		<fieldtype name="slong" class="solr.SortableLongField" sortMissingLast="true" omitNorms="true" />
		<fieldtype name="sfloat" class="solr.SortableFloatField" sortMissingLast="true" omitNorms="true" />
		<fieldtype name="sdouble" class="solr.SortableDoubleField" sortMissingLast="true" omitNorms="true" />

		<fieldtype name="date" class="solr.DateField" sortMissingLast="true" omitNorms="true" />

		<fieldtype name="text_spellcheck" class="solr.TextField" positionIncrementGap="100">
			<analyzer>
				<tokenizer class="solr.StandardTokenizerFactory" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_en.txt" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_fr.txt" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_de.txt" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_nl.txt" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_es.txt" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_it.txt" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_pt.txt" />
				<filter class="solr.ISOLatin1AccentFilterFactory" />
				<filter class="solr.LowerCaseFilterFactory" />
				<filter class="solr.LengthFilterFactory" min="5" max="25" />
			</analyzer>
		</fieldtype>

		<fieldtype name="text_ws" class="solr.TextField" positionIncrementGap="100">
			<analyzer>
				<tokenizer class="solr.WhitespaceTokenizerFactory" />
				<filter class="solr.LowerCaseFilterFactory" />
			</analyzer>
		</fieldtype>

		<fieldtype name="text_en" class="solr.TextField" positionIncrementGap="100">
			<analyzer>
				<tokenizer class="solr.WhitespaceTokenizerFactory" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_en.txt" />
				<filter class="solr.ChangeSynonymFilterFactory" synonyms="text_en" ignoreCase="true" expand="true" />
				<filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0" />
				<filter class="solr.LowerCaseFilterFactory" />
				<filter class="solr.EnglishPorterFilterFactory" protected="protwords.txt" />
				<filter class="solr.RemoveDuplicatesTokenFilterFactory" />
			</analyzer>
		</fieldtype>

		<fieldtype name="text_fr" class="solr.TextField">
			<analyzer>
				<tokenizer class="solr.StandardTokenizerFactory" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_fr.txt" />
				<filter class="solr.ChangeSynonymFilterFactory" synonyms="text_fr" ignoreCase="true" expand="true" />
				<filter class="solr.StandardFilterFactory" />
				<filter class="solr.LowerCaseFilterFactory" />
				<filter class="solr.SnowballPorterFilterFactory" language="French" />
				<filter class="solr.ISOLatin1AccentFilterFactory" />
			</analyzer>
		</fieldtype>

		<fieldtype name="text_de" class="solr.TextField">
			<analyzer>
				<tokenizer class="solr.StandardTokenizerFactory" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_de.txt" />
				<filter class="solr.ChangeSynonymFilterFactory" synonyms="text_de" ignoreCase="true" expand="true" />
				<filter class="solr.StandardFilterFactory" />
				<filter class="solr.LowerCaseFilterFactory" />
				<filter class="solr.SnowballPorterFilterFactory" language="German2" />
				<filter class="solr.ISOLatin1AccentFilterFactory" />
			</analyzer>
		</fieldtype>

		<fieldtype name="text_es" class="solr.TextField">
			<analyzer>
				<tokenizer class="solr.StandardTokenizerFactory" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_es.txt" />
				<filter class="solr.ChangeSynonymFilterFactory" synonyms="text_es" ignoreCase="true" expand="true" />
				<filter class="solr.StandardFilterFactory" />
				<filter class="solr.LowerCaseFilterFactory" />
				<filter class="solr.SnowballPorterFilterFactory" language="Spanish" />
				<filter class="solr.ISOLatin1AccentFilterFactory" />
			</analyzer>
		</fieldtype>

		<fieldtype name="text_nl" class="solr.TextField">
			<analyzer>
				<tokenizer class="solr.StandardTokenizerFactory" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_nl.txt" />
				<filter class="solr.ChangeSynonymFilterFactory" synonyms="text_nl" ignoreCase="true" expand="true" />
				<filter class="solr.StandardFilterFactory" />
				<filter class="solr.LowerCaseFilterFactory" />
				<filter class="solr.SnowballPorterFilterFactory" language="Dutch" />
				<filter class="solr.ISOLatin1AccentFilterFactory" />
			</analyzer>
		</fieldtype>

		<fieldtype name="text_it" class="solr.TextField">
			<analyzer>
				<tokenizer class="solr.StandardTokenizerFactory" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_it.txt" />
				<filter class="solr.ChangeSynonymFilterFactory" synonyms="text_it" ignoreCase="true" expand="true" />
				<filter class="solr.StandardFilterFactory" />
				<filter class="solr.LowerCaseFilterFactory" />
				<filter class="solr.SnowballPorterFilterFactory" language="Italian" />
				<filter class="solr.ISOLatin1AccentFilterFactory" />
			</analyzer>
		</fieldtype>

		<fieldtype name="text_pt" class="solr.TextField">
			<analyzer>
				<tokenizer class="solr.StandardTokenizerFactory" />
				<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_pt.txt" />
				<filter class="solr.ChangeSynonymFilterFactory" synonyms="text_pt" ignoreCase="true" expand="true" />
				<filter class="solr.StandardFilterFactory" />
				<filter class="solr.LowerCaseFilterFactory" />
				<filter class="solr.SnowballPorterFilterFactory" language="Portuguese" />
				<filter class="solr.ISOLatin1AccentFilterFactory" />
			</analyzer>
		</fieldtype>

	</types>

	<fields>

		<!-- Client relative document id, concatenation of the change document id and the document lang -->
		<field name="id" type="string" indexed="true" stored="true" />
		<!-- Id of the client -->
		<field name="client" type="string" indexed="true" stored="false" />
		<!-- Final id, which has to be stored  -->
		<field name="finalId" type="string" indexed="true" stored="true" />

		<!-- Change document model name string -->
		<field name="documentModel" type="string" indexed="true" stored="true" />

		<!-- Document lang eg: en, fr, de, ...-->
		<field name="lang" type="string" indexed="true" stored="true" />

		<!-- Allowed accessor ids for the document -->
		<field name="document_accessor" type="integer" indexed="true" stored="false" multiValued="true" />
	
		<!-- Allowed accessor ids for the document -->
		<field name="document_ancestor" type="integer" indexed="true" stored="false" multiValued="true" />

		<field name="fr_words" type="text_spellcheck" indexed="true" stored="false" multiValued="true" />
		<field name="en_words" type="text_spellcheck" indexed="true" stored="false" multiValued="true" />
		<field name="de_words" type="text_spellcheck" indexed="true" stored="false" multiValued="true" />
		<field name="nl_words" type="text_spellcheck" indexed="true" stored="false" multiValued="true" />
		<field name="es_words" type="text_spellcheck" indexed="true" stored="false" multiValued="true" />
		<field name="it_words" type="text_spellcheck" indexed="true" stored="false" multiValued="true" />
		<field name="pt_words" type="text_spellcheck" indexed="true" stored="false" multiValued="true" />
		
		<!-- Aggregate Text -->
		<field name="fr_aggregateText" type="text_ws"  indexed="true" stored="false" />
		<field name="en_aggregateText" type="text_ws"  indexed="true" stored="false" />
		<field name="de_aggregateText" type="text_ws"  indexed="true" stored="false" />
		<field name="nl_aggregateText" type="text_ws"  indexed="true" stored="false" />
		<field name="es_aggregateText" type="text_ws"  indexed="true" stored="false" />
		<field name="it_aggregateText" type="text_ws"  indexed="true" stored="false" />
		<field name="pt_aggregateText" type="text_ws"  indexed="true" stored="false" />
		
		<!-- Sortable Labels -->
		<field name="fr_sortableLabel" type="string"  indexed="true" stored="false" />
		<field name="en_sortableLabel" type="string"  indexed="true" stored="false" />
		<field name="de_sortableLabel" type="string"  indexed="true" stored="false" />
		<field name="nl_sortableLabel" type="string"  indexed="true" stored="false" />
		<field name="es_sortableLabel" type="string"  indexed="true" stored="false" />
		<field name="it_sortableLabel" type="string"  indexed="true" stored="false" />
		<field name="pt_sortableLabel" type="string"  indexed="true" stored="false" />
		
		<!-- Localized analyzed dynamic text fields, for instance label and text -->
		<dynamicField name="*_fr" type="text_fr" indexed="true" stored="true" omitNorms="true" />
		<dynamicField name="*_en" type="text_en" indexed="true" stored="true" omitNorms="true" />
		<dynamicField name="*_de" type="text_de" indexed="true" stored="true" omitNorms="true" />
		<dynamicField name="*_nl" type="text_nl" indexed="true" stored="true" omitNorms="true" />
		<dynamicField name="*_es" type="text_es" indexed="true" stored="true" omitNorms="true" />
		<dynamicField name="*_it" type="text_it" indexed="true" stored="true" omitNorms="true" />
		<dynamicField name="*_pt" type="text_pt" indexed="true" stored="true" omitNorms="true" />

		<!-- Some non-localized dynamic fields -->
		<dynamicField name="*_idx_str" type="string" indexed="true" stored="true" omitNorms="true" />
		<dynamicField name="*_idx_float" type="sfloat" indexed="true" stored="true" />
		<dynamicField name="*_idx_int" type="sint" indexed="true" stored="true" />
		<dynamicField name="*_idx_mul_int" type="sint" indexed="true" stored="false" multiValued="true" />
		<dynamicField name="*_idx_dt" type="date" indexed="true" stored="true" />
	</fields>

	<!-- field to use to determine and enforce document uniqueness. -->
	<uniqueKey>finalId</uniqueKey>
	<!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
	<solrQueryParser defaultOperator="OR" />

	<copyField source="label_fr" dest="fr_words" />
	<copyField source="label_en" dest="en_words" />
	<copyField source="label_de" dest="de_words" />
	<copyField source="label_nl" dest="nl_words" />
	<copyField source="label_es" dest="es_words" />
	<copyField source="label_it" dest="it_words" />
	<copyField source="label_pt" dest="pt_words" />

	<copyField source="text_fr" dest="fr_words" />
	<copyField source="text_en" dest="en_words" />
	<copyField source="text_de" dest="de_words" />
	<copyField source="text_nl" dest="nl_words" />
	<copyField source="text_es" dest="es_words" />
	<copyField source="text_it" dest="it_words" />
	<copyField source="text_pt" dest="pt_words" />
</schema>